<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página Inicial</title>
    <link rel="stylesheet" href="/css/estilos-navegacao.css">
    <link rel="stylesheet" href="/css/estilos-produtos.css">
</head>
<body>

<!-- Include Navigation Bar Partial -->
<%- include('partials/nav-user') %>

<!-- Conteúdo da Página -->
<main>
    <h1>Produtos em Destaque</h1>
    <p>Esse é o id da sessao do cliente: <%= sessaoId %></p>
    <button id="criarCarrinho">Criar Carrinho</button>
    <p id="resposta"></p>
    <script>
        document.getElementById('criarCarrinho').addEventListener('click', async () => {
            try {
                const resposta = await fetch('/api/carrinho', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                const dados = await resposta.json();

                if (dados.success) {
                    document.getElementById('resposta').textContent = `Carrinho criado! Id: ${dados.id_carrinho}`;
                } else {
                    document.getElementById('resposta').textContent = 'Erro ao criar carrinho.';
                }
            } catch (error) {
                console.error(error);
                document.getElementById('resposta').textContent = 'Erro na requisição.';
            }
        });

    </script>

    <!-- Product Cards -->
    <div class="produtos-container">
        <% if (produtos.length > 0) { %>
            <% produtos.forEach(produto => { %>
                <div class="produto-card">
                    <!-- Main Image -->
                    <div class="produto-imagem">
                        <img src="/uploads/<%= produto.imagens[0].url %>" alt="<%= produto.nome %>">
                    </div>

                    <!-- Product Name -->
                    <h3 class="produto-nome"><%= produto.nome %></h3>

                    <!-- Product Price -->
                    <p class="produto-preco">R$ <%= (Number(produto.preco) || 0.00).toFixed(2) %></p>

                    <!-- Detalhes Button -->
                    <button class="botao-detalhes" onclick="window.location.href='/clientes/produto/<%= produto.produto_id %>'">
                        Detalhes
                    </button>
                </div>
            <% }) %>
        <% } else { %>
            <p>Nenhum produto ativo encontrado.</p>
        <% } %>
    </div>
</main>

<!-- Scripts -->
<script>
    function verDetalhes(produtoId) {
        alert(`Detalhes do produto ${produtoId} ainda não implementados.`);
    }
</script>

</body>
</html>
